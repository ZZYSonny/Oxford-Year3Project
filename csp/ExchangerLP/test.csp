include "correct.csp"

----------------------------------
--Test for two process
--Where one always exchange A
--The second always exchange B
System1 = runWith(True,True,
  runP(exchange(T1,A)) |||
  runP(exchange(T2,B))
)
--check the system obeys the linearizer
--Spec2Thread = Linearizers({T1, T2}) 
assert Spec [T= System1

--check the same system never deadlock and diverges only because of spurious wakeup
System2 = runWith(False,True,
  runP(exchange(T1,A)) |||
  runP(exchange(T2,B))
)
assert System2 :[deadlock free]
----------------------------------
--Test for three process
--Where one always exchange A
--The second always exchange B
--The third always exchange C
System3 = runWith(True,True,
  runP(exchange(T1,A)) |||
  runP(exchange(T2,B)) |||
  runP(exchange(T3,C))
)
assert Spec [T= System3

System4 = runWith(False,True,
  runP(exchange(T1,A)) |||
  runP(exchange(T2,B)) |||
  runP(exchange(T3,C))
)
assert System4 :[deadlock free]